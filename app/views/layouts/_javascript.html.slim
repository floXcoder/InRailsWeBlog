javascript:
    window.railsEnv = "#{Rails.env}";
    window.settings = JSON.parse('#{raw CONFIG.to_hash.merge(Setting.get_all).to_json}');

    window.userLatitude = "#{@user_latitude}";
    window.userLongitutde = "#{@user_longitude}";
    window.userJustSign = "#{session[:user_just_sign]}";

    window.I18n = {};
    window.defaultLocale = "#{I18n.default_locale}";
    window.locale = "#{I18n.locale}";

    window.revision = "#{REVISION}";

    var _paq = _paq || [];

- session[:user_just_sign] = false if session[:user_just_sign]

- if current_user
  javascript:
      window.currentUserId = "#{current_user.id}";
      window.currentUserSlug = "#{current_user.slug}";
      window.currentTopicId = "#{current_user.current_topic.id}";
      window.currentTopicSlug = "#{current_user.current_topic.slug}";

- if current_admin
  javascript:
      window.currentAdminId = "#{current_admin.id}";
      window.currentAdminPseudo = "#{current_admin.pseudo}";

= render 'layouts/error_reporting'

= yield(:javascript)
